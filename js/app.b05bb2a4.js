(function(e){function t(t){for(var n,a,s=t[0],u=t[1],c=t[2],d=0,f=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);l&&l(t);while(f.length)f.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,s=1;s<r.length;s++){var u=r[s];0!==o[u]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},o={app:0},i=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/library-viewer/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0a0a":function(e,t,r){"use strict";r("1293")},1293:function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("4de4"),r("4160"),r("a15b"),r("45fc"),r("4fad"),r("d3b7"),r("07ac"),r("4d63"),r("ac1f"),r("25f0"),r("5319"),r("1276"),r("159b");var n=r("3835"),o=(r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("2b0e")),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("load-box"),this.$root.library&&Object.keys(this.$root.library).length?r("search-bar"):e._e(),r("div",{staticClass:"productions"},e._l(e.filteredProductions,(function(e){return r("production",{key:e.id,attrs:{production:e,filteredTours:e.filteredTours}})})),1),this.$root.library&&Object.keys(this.$root.library).length?r("library-pager"):e._e()],1)},a=[],s=(r("fb6a"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("label",[e._v(" Load library.json "),r("input",{attrs:{type:"file",accept:".json"},on:{change:e.loadFile}})]),e.loading?r("div",[e._v(" Loading.... ")]):e._e(),e.error?r("div",[e._v(" Error loading library from "+e._s(e.fileName)+". Try again. ")]):e._e()])}),u=[],c=(r("b0c0"),r("2ef0"),{name:"LoadBox",data:function(){return{loading:!1,error:!1,fileName:""}},methods:{loadFile:function(e){var t=this,r=e.target.files[0];t.fileName=r.name;var n=new FileReader;n.addEventListener("load",(function(){var e;t.loading=!0,t.error=!1;try{e=JSON.parse(n.result)}catch(r){return t.error=!0,void(t.loading=!1)}t.$root.getVueItems(e),t.loading=!1,t.error=!1})),n.readAsText(r)}}}),l=c,d=r("2877"),f=Object(d["a"])(l,s,u,!1,null,null,null),p=f.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-bar"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"form-control",attrs:{id:"query-box",type:"text",placeholder:"Search for...",autofocus:""},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}}),r("span",[e._v(" Filtering "+e._s(this.$store.getters.queriedPerformances.length)+" of "+e._s(this.$store.state.performances.length)+" Performances ")])])},h=[],m={computed:{query:{get:function(){return this.$store.state.query},set:_.debounce((function(e){return this.$store.commit("updateQuery",e)}),500)}}},y=m,v=Object(d["a"])(y,g,h,!1,null,null,null),b=v.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.production.title?r("div",{staticClass:"production"},[r("h3",{staticClass:"production-name",attrs:{id:e.production.slug}},[r("a",{attrs:{href:"#"+e.production.slug}},[e._v(e._s(e.production.title))])]),e._l(e.sortedByTitle(e.filteredTours),(function(e){return r("tour",{key:e.id,attrs:{tour:e,"filtered-performances":e.filteredPerformances}})}))],2):e._e()},w=[],$=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tour",attrs:{id:e.tour.slug}},[e.tour.filteredPerformances.length?r("h4",{staticClass:"tour-name"},[e._v(" "+e._s(e.tour.productionTitle)+" - "),r("a",{attrs:{href:"#"+e.tour.slug}},[e._v(e._s(e.tour.title))])]):e._e(),r("div",{staticClass:"performances"},e._l(e.filteredPerformances,(function(t){return r("performance",{key:t.id,attrs:{id:t.id,"production-title":e.tour.productionTitle,"production-id":e.tour.production_id,"tour-title":e.tour.title,"tour-short-title":e.tour.short_title,"tour-id":e.tour.id,date:t.date,matinee:Boolean(t.matinee),"day-not-known":Boolean(t.day_not_known),cast:t.cast,slug:t.slug,location:t.location}})})),1)])},T=[],j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"performance",attrs:{"v-performance_id":e.id,id:e.slug}},[r("h5",[r("span",{staticClass:"date",domProps:{innerHTML:e._s(e.performanceTitleHighlighted)}})]),r("div",[r("span",{staticClass:"cast",domProps:{innerHTML:e._s(e.castHighlighted)}})])])},q=[],O=(r("99af"),r("a9e3"),r("2ef0")),S=r("5a0c"),x={props:{productionTitle:{type:String,required:!0},productionId:{type:Number,requires:!0},tourTitle:{type:String,required:!0},tourShortTitle:{type:String,required:!0},tourId:{type:Number,required:!0},date:{type:String,required:!0},matinee:{type:Boolean,required:!0},dayNotKnown:{type:Boolean,required:!0},id:{type:Number,required:!0},cast:{type:String,required:!0},slug:{type:String,required:!0},location:{type:String}},computed:{query:function(){return this.$store.state.query},performanceTitleHighlighted:function(){var e=O.escape(this.productionTitle),t=O.escape(this.tourTitle),r=O.escape(this.location);r&&(t+=" (".concat(r,")"));var n=O.escape(this.tourShortTitle);n=t;var o,i=n,a=O.escape(this.date),s=S(this.date);if(o=!this.dayNotKnown&&s.isValid()?s.format("MMMM D, YYYY"):a,this.matinee&&(o+=" matinée"),this.query){var u="("+this.query+")",c=new RegExp(u,"gi");e=e.replace(c,'<span class="highlight">$1</span>'),i=n.replace(c,'<span class="highlight">$1</span>'),o=o.replace(c,'<span class="highlight">$1</span>')}return i='<span title="'.concat(t,'">').concat(i,"</span>"),o='<a href="#'.concat(this.slug,'">').concat(o,"</a>"),"".concat(e," - ").concat(i," - ").concat(o)},castHighlighted:function(){var e=O.escape(this.cast);if(!this.query)return e;var t="("+this.query+")",r=new RegExp(t,"gi");return e.replace(r,'<span class="highlight">$1</span>')}}},E=x,k=(r("6022"),r("aa9d"),Object(d["a"])(E,j,q,!1,null,"803ffaca",null)),B=k.exports,C={components:{Performance:B},props:{tour:Object,filteredPerformances:Array}},M=C,N=Object(d["a"])(M,$,T,!1,null,null,null),I=N.exports,L={name:"Production",props:{production:Object,filteredTours:Object},components:{Tour:I}},H=L,R=(r("0a0a"),Object(d["a"])(H,P,w,!1,null,"6e95a168",null)),F=R.exports,Y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"library-pager"},[r("a",{attrs:{href:"javascript:;"},on:{click:e.decrementPage}},[e._v(" Prev ")]),e._l(e.numPages,(function(t){return r("a",{key:t,class:{selected:e.isCurPage(t)},attrs:{href:"javascript:;"},on:{click:function(r){return e.setPage(t)}}},[e._v(" "+e._s(t)+" ")])})),r("a",{attrs:{href:"javascript:;"},on:{click:e.incrementPage}},[e._v(" Next ")])],2)},A=[],J={computed:{curPage:function(){return this.$store.state.page},perPage:{get:function(){return this.$store.state.perPage},set:_.debounce((function(e){e>9&&this.$store.commit("setPerPage",e)}),300)},numPages:function(){return this.$store.getters.numPages}},methods:{decrementPage:function(){this.$store.state.page>0&&this.$store.commit("decrementPage")},incrementPage:function(){this.$store.state.page<this.numPages&&this.$store.commit("incrementPage")},setPage:function(e){this.$store.commit("setPage",e)},isCurPage:function(e){return e===this.curPage}}},V=J,K=(r("92ae"),Object(d["a"])(V,Y,A,!1,null,"0231ed31",null)),Q=K.exports,W={name:"Library",components:{LoadBox:p,SearchBar:b,Production:F,LibraryPager:Q},computed:{filteredProductions:function(){var e=this,t={},r=(e.$store.state.page-1)*e.$store.state.perPage,n=e.$store.state.page*e.$store.state.perPage,o=_.sortBy(e.$store.getters.queriedPerformances,["productionTitle","tourTitle","date"]).slice(r,n);return _.each(o,(function(r){var n=_.get(t,r.production_id);if(void 0===n){if(n=e.$root.library[r.production_id],!n)return;n.filteredTours={},t[n.id]=n}var o=_.get(n.filteredTours,r.tour_id);void 0===o&&(o=n.tours[r.tour_id],o.filteredPerformances=[],n.filteredTours[o.id]=o),o.filteredPerformances.push(r)})),_.sortBy(t,"title")}}},z=W,D=Object(d["a"])(z,i,a,!1,null,null,null),G=D.exports;window._=r("2ef0"),window.slugify=function(e){var t="àáäâèéëêìíïîòóöôùúüûñçßÿœæŕśńṕẃǵǹḿǘẍźḧ·/_,:;",r="aaaaeeeeiiiioooouuuuncsyoarsnpwgnmuxzh------",n=new RegExp(t.split("").join("|"),"g");return e.toString().replace(n,(function(e){return r.charAt(t.indexOf(e))})).replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"")};var U=r("2f62");o["a"].use(U),o["a"].mixin({methods:{slugify:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return slugify})),sortedByTitle:function(e){return _.sortBy(e,"title")}}}),o["a"].config.productionTip=!1;var X=new U.Store({state:{collection:[],wants:[],performances:[],query:"",page:1,perPage:10,showImages:!1},getters:{numPages:function(e,t){var r=Math.ceil(t.queriedPerformances.length/e.perPage);return r&&e.page>r&&X.commit("setPage",r),r||1},queriedPerformances:function(e){if(""===e.query)return e.performances;var t=RegExp(e.query,"i");return _.filter(e.performances,(function(e){var r=_.pick(e,["productionTitle","tourTitle","tourShortTitle","cast","date","notes","slug"]);return _.some(r,(function(e){if(_.isString(e)&&t.test(e))return"13"==r["productionTitle"]&&console.log(e),1}))}))}},mutations:{updateQuery:function(e,t){e.query=t},updateShowImages:function(e,t){e.showImages=t},incrementPage:function(e){e.page++},decrementPage:function(e){e.page=--e.page||1},setPage:function(e,t){e.page=t},setPerPage:function(e,t){e.perPage=t,e.page*e.perPage>e.performances.length&&(e.page=Math.ceil(e.performances.length/e.perPage)||1)},setPerformances:function(e,t){e.performances=t}}});function Z(e,t,r){o["a"].set(te,"library",{}),e.forEach((function(e){e.tours={},o["a"].set(te.library,e.id,e)}));var n={};t.forEach((function(e){e.performances=[],n[e.id]=e;var t=te.library[e.production_id];e.productionTitle=t.title,o["a"].set(te.library[e.production_id].tours,e.id,e)})),_.each(_.sortBy(r,"date"),(function(e){var t=n[e.tour_id],r=te.library[t.production_id],o=t.production_id;e.production_id=o,e.productionTitle=r.title,e.tourTitle=t.title,e.tourShortTitle=t.short_title,e.tourSlug=t.slug,n[e.tour_id]["performances"].push(e)}))}function ee(e,t){var r=this;o["a"].set(this,"library",{});var i=[];Object.values(t).forEach((function(e){var t;o["a"].set(r.library,e.id,e),Object.entries(null!==(t=e.tours)&&void 0!==t?t:{}).forEach((function(e){var t,r=Object(n["a"])(e,2),o=(r[0],r[1]);Object.entries(null!==(t=o.performances)&&void 0!==t?t:{}).forEach((function(e){var t=Object(n["a"])(e,2),r=(t[0],t[1]);i.push(r)}))}))})),e.$store.commit("setPerformances",i)}window.store=X;var te=new o["a"]({store:X,data:{library:void 0,performances:[]},render:function(e){return e(G)},components:{},mounted:function(){window.innerWidth>1023?this.$store.commit("setPerPage",50):window.innerWidth>767&&this.$store.commit("setPerPage",25),console.log("mounted"),window.location.hash=window.location.hash},computed:{showImages:{get:function(){return this.$store.state.showImages},set:function(e){this.$store.commit("updateShowImages",e)}}},methods:{getVueItems:function(e){var t,r,n,o,i=this;e=null!==(t=e)&&void 0!==t?t:{};var a=null!==(r=e.productions)&&void 0!==r?r:{},s=null!==(n=e.tours)&&void 0!==n?n:[],u=null!==(o=e.performances)&&void 0!==o?o:[];return a.length?(i.$store.commit("setPerformances",u),Z(a,s,u)):ee(i,a)},sortedByTitle:function(e){return _.sortBy(e,"title")},slugify:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return slugify(e)})),productionHref:function(){return"#"}}}).$mount("#app")},6022:function(e,t,r){"use strict";r("da6e")},"92ae":function(e,t,r){"use strict";r("9ddb")},"9ddb":function(e,t,r){},a940:function(e,t,r){},aa9d:function(e,t,r){"use strict";r("a940")},da6e:function(e,t,r){}});
//# sourceMappingURL=app.b05bb2a4.js.map